<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>cluster.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Cluster.html">Cluster</a><ul class='methods'><li data-type='method'><a href="Cluster.html#clusterify">clusterify</a></li></ul></li><li><a href="Mass.html">Mass</a><ul class='methods'><li data-type='method'><a href="Mass.html#probe">probe</a></li><li data-type='method'><a href="Mass.html#probeRequestToCoords">probeRequestToCoords</a></li><li data-type='method'><a href="Mass.html#serialize">serialize</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-3d-adjacency.html">3d-adjacency</a><ul class='methods'><li data-type='method'><a href="module-3d-adjacency.html#~find">find</a></li><li data-type='method'><a href="module-3d-adjacency.html#~nodeSorter">nodeSorter</a></li><li data-type='method'><a href="module-3d-adjacency.html#~sort">sort</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">cluster.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict'

const c = require('./constants')
const Mass = require('./mass')

/**
 * @class
 * @property {array[][]} domain
 * @property {object} knownMass
 * @property {Mass} root original Mass node found
 * @property {Mass[]} massNodes
 */
class Cluster {
  constructor (conf) {
    this.domain = conf.domain
    this.knownMass = conf.knownMass
    this.root = conf.root
    this.massNodes = [this.root]
  }

  /**
   * searches for all connected Mass recursively, node-to-node.
   * updates the domain's `knownMass` as it goes as a side-effect.
   * @returns {array[]} `this.massNodes`. nodes that belong to this cluster
   */
  clusterify () {
    this.massNodes = [this.root]
    this._clusterify(this.root)
    return this.massNodes
  }

  /**
   * recursively probes nodes to add to the cluster
   * @private
   * @param {Mass} root
   * @returns {undefined}
   */
  _clusterify (root) {
    var massNode
    var addr
    var coords
    var probeRequest
    var toProbe = [root]
    var node
    while (toProbe.length) {
      node = toProbe[0]
      for (var n in c.CLUSTER_ADJACENCY_DIRS) {
        probeRequest = c.CLUSTER_ADJACENCY_DIRS[n]
        coords = node.probe.apply(node, probeRequest)
        if (coords) {
          addr = `${coords.x}${coords.y}${coords.z}`
          if (!this.knownMass.hasOwnProperty(addr)) {
            massNode = new Mass({
              domain: this.domain,
              x: coords.x,
              y: coords.y,
              z: coords.z,
              value: this.domain[coords.x][coords.y][coords.z]
            })
            this.knownMass[addr] = massNode.value
            this.massNodes.push(massNode)
            toProbe.push(massNode)
          }
        }
      }
      toProbe.shift()
    }
  }

  serialize () {
    return this.massNodes.map(mn => mn.serialize())
  }
}

module.exports = Cluster
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
